!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{Db1F:function(n,i,o){"use strict";o.r(i),o.d(i,"AddNewFoodsPageModule",function(){return I});var r=o("ofXK"),a=o("3Pt+"),s=o("TEn/"),c=o("tyNb"),l=o("mrSG"),u=o("a/9d"),d=o("8RPc"),h=o("2Rin"),b=o("24Ct"),g=o("fXoL");function p(e,t){if(1&e&&(g.Ob(0,"ion-title"),g.rc(1),g.Nb()),2&e){var n=g.Yb();g.Ab(1),g.sc(n.util.translate("Editar producto"))}}function m(e,t){if(1&e&&(g.Ob(0,"ion-title"),g.rc(1),g.Nb()),2&e){var n=g.Yb();g.Ab(1),g.sc(n.util.translate("A\xf1adir producto"))}}function f(e,t){if(1&e&&(g.Ob(0,"ion-select-option",20),g.rc(1),g.Nb()),2&e){var n=t.$implicit;g.ec("value",n.id),g.Ab(1),g.sc(n.name)}}function v(e,t){if(1&e){var n=g.Pb();g.Ob(0,"div",21),g.Wb("click",function(){return g.mc(n),g.Yb().cover()}),g.Mb(1,"ion-icon",22),g.Ob(2,"p"),g.rc(3),g.Nb(),g.Nb()}if(2&e){var i=g.Yb();g.Ab(3),g.sc(i.util.translate("Portada"))}}var O=function(e){return{"background-image":e}};function y(e,t){if(1&e){var n=g.Pb();g.Ob(0,"div",23),g.Wb("click",function(){return g.mc(n),g.Yb().cover()}),g.Nb()}if(2&e){var i=g.Yb();g.ec("ngStyle",g.jc(1,O,"url("+i.api.mediaURL+i.coverImage+"),url(assets/placeholder.jpg)"))}}function C(e,t){if(1&e){var n=g.Pb();g.Ob(0,"ion-icon",28),g.Wb("click",function(){g.mc(n);var e=g.Yb().index;return g.Yb().editTitle(e)}),g.Nb()}}function k(e,t){if(1&e){var n=g.Pb();g.Ob(0,"ion-item",29),g.Ob(1,"ion-label"),g.rc(2),g.Ob(3,"ion-label"),g.rc(4),g.Nb(),g.Nb(),g.Ob(5,"ion-icon",28),g.Wb("click",function(){g.mc(n);var e=t.$implicit,i=t.index,o=g.Yb().index;return g.Yb().editSub(o,e,i)}),g.Nb(),g.Ob(6,"ion-icon",30),g.Wb("click",function(){g.mc(n);var e=t.$implicit,i=g.Yb().index;return g.Yb().deleteSub(i,e)}),g.Nb(),g.Nb()}if(2&e){var i=t.$implicit;g.Ab(2),g.tc("",i.title," "),g.Ab(2),g.sc(i.price)}}function w(e,t){if(1&e){var n=g.Pb();g.Ob(0,"ion-item-sliding"),g.Ob(1,"ion-item",15),g.Ob(2,"ion-label"),g.rc(3),g.Nb(),g.qc(4,C,1,0,"ion-icon",24),g.Ob(5,"ion-icon",25),g.Wb("click",function(){g.mc(n);var e=t.index;return g.Yb().addItem(e)}),g.Nb(),g.Ob(6,"ion-icon",26),g.Wb("click",function(){g.mc(n);var e=t.$implicit;return g.Yb().delete(e)}),g.Nb(),g.Nb(),g.qc(7,k,7,2,"ion-item",27),g.Nb()}if(2&e){var i=t.$implicit;g.Ab(3),g.sc(i.title),g.Ab(1),g.ec("ngIf","size"!==i.title),g.Ab(3),g.ec("ngForOf",i.items)}}var x,N,A,S=[{path:"",component:(x=function(){function n(t,i,o,r,a,s,c,l,u){var d=this;e(this,n),this.actionSheetController=t,this.camera=i,this.util=o,this.api=r,this.router=a,this.navCtrl=s,this.route=c,this.alertController=l,this.modalCtrl=u,this.categories=[],this.image="",this.isEdit=!1,this.veg="1",this.status="1",this.variations=[],this.size="0",this.category(),this.route.queryParams.subscribe(function(e){console.log("data=>",e),e.hasOwnProperty("id")?(d.id=e.id,d.isEdit=!0,d.getProduct()):d.isEdit=!1})}var i,o,r;return i=n,(o=[{key:"getProduct",value:function(){var e=this,t={id:this.id};this.util.show(),this.api.post("products/getById",t).then(function(t){if(console.log(t),e.util.hide(),t&&200===t.status&&t.data.length>0){var n=t.data[0];console.log("info->",n),e.name=n.name,e.descriptions=n.details,e.coverImage=n.cover,e.cid=n.cid,e.price=n.price,e.size=n.size,e.status=n.status,e.veg=n.veg,function(e){try{return JSON.parse(e),!0}catch(t){return!1}}(n.variations)&&(e.variations=JSON.parse(n.variations))}else e.util.errorToast(e.util.translate("Product not found"))},function(t){console.log(t),e.util.hide(),e.util.errorToast(e.util.translate("Something went wrong"))}).catch(function(t){console.log(t),e.util.hide(),e.util.errorToast(e.util.translate("Something went wrong"))})}},{key:"ngOnInit",value:function(){}},{key:"category",value:function(){var e=this,t={id:localStorage.getItem("uid")};this.api.post("categories/getByRestId",t).then(function(t){t&&200===t.status&&t.data.length&&(e.categories=t.data)},function(t){console.log(t),console.log(t),e.util.errorToast(e.util.translate("Something went wrong"))}).catch(function(t){console.log(t),console.log(t),e.util.errorToast(e.util.translate("Something went wrong"))})}},{key:"changeSize",value:function(e){if(console.log(e,this.size),"1"===e){var t=this.variations.filter(function(e){return"size"===e.title});console.log("length",t),t.length||(this.variations.push({title:"size",type:"radio",items:[]}),console.log(this.variations))}else this.variations=this.variations.filter(function(e){return"size"!==e.title})}},{key:"cover",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.actionSheetController.create({header:this.util.translate("Choose from"),mode:"ios",buttons:[{text:this.util.translate("Camera"),icon:"camera",handler:function(){console.log("Delete clicked"),n.opemCamera("camera")}},{text:this.util.translate("Gallery"),icon:"image",handler:function(){console.log("Share clicked"),n.opemCamera("gallery")}},{text:this.util.translate("Cancel"),icon:"close",role:"cancel",handler:function(){console.log("Cancel clicked")}}]});case 2:return t=e.sent,e.next=5,t.present();case 5:case"end":return e.stop()}},e,this)}))}},{key:"addNew",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.alertController.create({header:"Add Add-ons!",inputs:[{name:"name",type:"text",placeholder:"Title"}],buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(){console.log("Confirm Cancel")}},{text:"Ok",handler:function(e){if(console.log("Confirm Ok"),e&&e.name){var t=n.variations.filter(function(t){return t.title===e.name});console.log('=>"',t),t&&t.length>0?n.util.errorToast("Duplicate"):n.presentAlertRadio(e.name)}}}]});case 2:return t=e.sent,e.next=5,t.present();case 5:case"end":return e.stop()}},e,this)}))}},{key:"editTitle",value:function(e){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alertController.create({header:"Edit title!",inputs:[{name:"name",type:"text",placeholder:"Title",value:this.variations[e].title}],buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(){console.log("Confirm Cancel")}},{text:"Ok",handler:function(t){console.log("Confirm Ok"),t&&t.name&&(i.variations[e].title=t.name)}}]});case 2:return n=t.sent,t.next=5,n.present();case 5:case"end":return t.stop()}},t,this)}))}},{key:"presentAlertRadio",value:function(e){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alertController.create({header:"Select Type",inputs:[{name:"radio1",type:"radio",label:"Only One",value:"radio",checked:!0},{name:"radio2",type:"radio",label:"Multiple",value:"check"}],buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(){console.log("Confirm Cancel")}},{text:"Ok",handler:function(t){console.log("Confirm Ok"),i.variations.push({title:e,type:t,items:[]}),console.log(i.variations)}}]});case 2:return n=t.sent,t.next=5,n.present();case 5:case"end":return t.stop()}},t,this)}))}},{key:"opemCamera",value:function(e){var t=this;try{this.camera.getPicture({quality:100,targetHeight:800,targetWidth:800,destinationType:this.camera.DestinationType.DATA_URL,encodingType:this.camera.EncodingType.JPEG,mediaType:this.camera.MediaType.PICTURE,correctOrientation:!0,sourceType:"camera"===e?this.camera.PictureSourceType.CAMERA:this.camera.PictureSourceType.PHOTOLIBRARY}).then(function(e){console.log("url->",e),t.util.show();var n={img:e,type:"jpg"};console.log("parma==>",n),t.api.nativePost("users/upload_file",n).then(function(e){t.util.hide(),console.log("data",JSON.parse(e.data));var n=JSON.parse(e.data);t.coverImage=n.data,console.log("cover image",t.coverImage)},function(e){console.log(e),t.util.hide(),t.util.errorToast(t.util.translate("Something went wrong"))}).catch(function(e){console.log(e),t.util.hide(),t.util.errorToast(t.util.translate("Something went wrong"))})})}catch(n){console.log("error",n)}}},{key:"submit",value:function(){var e=this;if(!(""!==this.name&&this.name&&""!==this.cid&&this.cid&&""!==this.price&&this.price&&""!==this.descriptions&&this.descriptions))return this.util.errorToast(this.util.translate("All Fields are required")),!1;if(!this.coverImage||""===this.coverImage)return this.util.errorToast(this.util.translate("Please add your cover image")),!1;if(this.isEdit&&this.id){var t={restId:localStorage.getItem("uid"),cid:this.cid,name:this.name,price:this.price,details:this.descriptions,cover:this.coverImage,veg:this.veg,status:this.status,variations:JSON.stringify(this.variations),size:this.size,id:this.id};this.util.show(),this.api.post("products/editList",t).then(function(t){e.util.hide(),t&&200===t.status?(e.util.showToast(e.util.translate("Food updated Successfully"),"success","bottom"),e.navCtrl.back()):e.util.errorToast(e.util.translate("Something went wrong"))},function(t){console.log(t),e.util.hide(),e.util.errorToast(e.util.translate("Something went wrong"))}).catch(function(t){console.log(t),e.util.hide(),e.util.errorToast(e.util.translate("Something went wrong"))})}else{var n={restId:localStorage.getItem("uid"),cid:this.cid,name:this.name,price:this.price,details:this.descriptions,cover:this.coverImage,rating:0,veg:this.veg,status:1,variations:JSON.stringify(this.variations),size:this.size};this.util.show(),this.api.post("products/save",n).then(function(t){e.util.hide(),t&&200===t.status?(e.util.showToast(e.util.translate("Food Added Successfully"),"success","bottom"),e.navCtrl.back()):e.util.errorToast(e.util.translate("Something went wrong"))},function(t){console.log(t),e.util.hide(),e.util.errorToast(e.util.translate("Something went wrong"))}).catch(function(t){console.log(t),e.util.hide(),e.util.errorToast(e.util.translate("Something went wrong"))})}}},{key:"delete",value:function(e){console.log(e),"size"===e.title&&(this.size=!1),this.variations=this.variations.filter(function(t){return t.title!==e.title})}},{key:"addItem",value:function(e){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(this.variations[e]),t.next=3,this.alertController.create({header:"Add item to "+this.variations[e].title,inputs:[{name:"title",type:"text",placeholder:"Add-ons name"},{name:"price",type:"number",placeholder:"Add-ons price"}],buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(){console.log("Confirm Cancel")}},{text:"Ok",handler:function(t){console.log("Confirm Ok"),t&&t.title&&t.price&&(i.variations[e].items.push({title:t.title,price:t.price}),console.log(i.variations))}}]});case 3:return n=t.sent,t.next=6,n.present();case 6:case"end":return t.stop()}},t,this)}))}},{key:"deleteSub",value:function(e,t){console.log(e),console.log(t);var n=this.variations[e].items;console.log("selected",n);var i=n.filter(function(e){return e.title!==t.title});console.log(i),this.variations[e].items=i,console.log("done",this.variations)}},{key:"editSub",value:function(e,t,n){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark(function i(){var o,r=this;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return console.log(e,t,n),console.log(this.variations),i.next=3,this.alertController.create({header:"Edit item "+this.variations[e].title,inputs:[{name:"title",type:"text",placeholder:"Variation name",value:this.variations[e].items[n].title},{name:"price",type:"number",placeholder:"Variation price",value:this.variations[e].items[n].price}],buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(){console.log("Confirm Cancel")}},{text:"Ok",handler:function(t){console.log("Confirm Ok"),r.variations[e].items[n].title=t.title,r.variations[e].items[n].price=t.price,console.log(r.variations)}}]});case 3:return o=i.sent,i.next=6,o.present();case 6:case"end":return i.stop()}},i,this)}))}},{key:"preview",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalCtrl.create({component:b.a,cssClass:"custom_modal2",componentProps:{name:this.name,variations:this.variations,desc:this.descriptions}});case 2:return t=e.sent,e.next=5,t.present();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}))}}])&&t(i.prototype,o),r&&t(i,r),n}(),x.\u0275fac=function(e){return new(e||x)(g.Lb(s.a),g.Lb(u.a),g.Lb(h.a),g.Lb(d.a),g.Lb(c.g),g.Lb(s.cb),g.Lb(c.a),g.Lb(s.b),g.Lb(s.bb))},x.\u0275cmp=g.Fb({type:x,selectors:[["app-add-new-foods"]],decls:36,vars:17,consts:[["color","primary"],["slot","start"],[3,"click"],["slot","icon-only","name","arrow-back"],[4,"ngIf"],[1,"ion-padding"],[1,"mainContent"],["lines","none"],["interface","popover","mode","ios",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","text",3,"ngModel","placeholder","ngModelChange"],["type","number",3,"ngModel","placeholder","ngModelChange"],["rows","5",3,"ngModel","placeholder","ngModelChange"],["class","coverPlaceholder",3,"click",4,"ngIf"],["class","coverReal",3,"ngStyle","click",4,"ngIf"],[1,"noLines"],["name","add","slot","end",3,"click"],[4,"ngFor","ngForOf"],["size","6"],["expand","block",3,"click"],[3,"value"],[1,"coverPlaceholder",3,"click"],["name","cloud-upload-outline","color","primary"],[1,"coverReal",3,"ngStyle","click"],["name","create-outline","slot","end",3,"click",4,"ngIf"],["name","add-circle","slot","end",3,"click"],["name","trash","slot","end",3,"click"],["class","sub","lines","nones",4,"ngFor","ngForOf"],["name","create-outline","slot","end",3,"click"],["lines","nones",1,"sub"],["name","trash-outline","slot","end",3,"click"]],template:function(e,t){1&e&&(g.Ob(0,"ion-header"),g.Ob(1,"ion-toolbar",0),g.Ob(2,"ion-buttons",1),g.Ob(3,"ion-button",2),g.Wb("click",function(){return t.util.back()}),g.Mb(4,"ion-icon",3),g.Nb(),g.Nb(),g.qc(5,p,2,1,"ion-title",4),g.qc(6,m,2,1,"ion-title",4),g.Nb(),g.Nb(),g.Ob(7,"ion-content",5),g.Ob(8,"div",6),g.Ob(9,"ion-list",7),g.Ob(10,"ion-item"),g.Ob(11,"ion-label"),g.rc(12),g.Nb(),g.Ob(13,"ion-select",8),g.Wb("ngModelChange",function(e){return t.cid=e}),g.qc(14,f,2,2,"ion-select-option",9),g.Nb(),g.Nb(),g.Ob(15,"ion-item"),g.Ob(16,"ion-input",10),g.Wb("ngModelChange",function(e){return t.name=e}),g.Nb(),g.Nb(),g.Ob(17,"ion-item"),g.Ob(18,"ion-input",11),g.Wb("ngModelChange",function(e){return t.price=e}),g.Nb(),g.Nb(),g.Ob(19,"ion-item"),g.Ob(20,"ion-textarea",12),g.Wb("ngModelChange",function(e){return t.descriptions=e}),g.Nb(),g.Nb(),g.qc(21,v,4,1,"div",13),g.qc(22,y,1,3,"div",14),g.Ob(23,"ion-item",15),g.Ob(24,"ion-label"),g.rc(25),g.Nb(),g.Ob(26,"ion-icon",16),g.Wb("click",function(){return t.addNew()}),g.Nb(),g.Nb(),g.Ob(27,"ion-list"),g.qc(28,w,8,3,"ion-item-sliding",17),g.Nb(),g.Ob(29,"ion-row"),g.Ob(30,"ion-col",18),g.Ob(31,"ion-button",19),g.Wb("click",function(){return t.submit()}),g.rc(32),g.Nb(),g.Nb(),g.Ob(33,"ion-col",18),g.Ob(34,"ion-button",19),g.Wb("click",function(){return t.preview()}),g.rc(35),g.Nb(),g.Nb(),g.Nb(),g.Nb(),g.Nb(),g.Nb()),2&e&&(g.Ab(5),g.ec("ngIf",t.isEdit),g.Ab(1),g.ec("ngIf",!t.isEdit),g.Ab(6),g.sc(t.util.translate("Categoria")),g.Ab(1),g.ec("ngModel",t.cid),g.Ab(1),g.ec("ngForOf",t.categories),g.Ab(2),g.ec("ngModel",t.name)("placeholder",t.util.translate("Nombre del producto")),g.Ab(2),g.ec("ngModel",t.price)("placeholder",t.util.translate("Precio")),g.Ab(2),g.ec("ngModel",t.descriptions)("placeholder",t.util.translate("Descripcion corta")),g.Ab(1),g.ec("ngIf",!t.coverImage||""==t.coverImage),g.Ab(1),g.ec("ngIf",t.coverImage&&""!=t.coverImage),g.Ab(3),g.sc(t.util.translate("Extas")),g.Ab(3),g.ec("ngForOf",t.variations),g.Ab(4),g.tc(" ",t.isEdit?"Actualizar":"Agregar"," "),g.Ab(3),g.sc(t.util.translate("Vista previa de extras")))},directives:[s.o,s.W,s.g,s.f,s.p,r.i,s.j,s.u,s.r,s.t,s.I,s.ib,a.i,a.l,r.h,s.q,s.jb,s.eb,s.T,s.E,s.i,s.V,s.J,r.j,s.s],styles:["ion-item[_ngcontent-%COMP%]{border:1px solid #d3d3d3;border-radius:5px;margin-top:10px}.delete_icn[_ngcontent-%COMP%]{color:#fff;font-weight:600}.mainContent[_ngcontent-%COMP%]   .coverPlaceholder[_ngcontent-%COMP%]{text-align:center;padding:60px;border:1px solid #d3d3d3;border-radius:10px;margin-top:10px}.mainContent[_ngcontent-%COMP%]   .coverReal[_ngcontent-%COMP%]{margin-top:10px;width:100%;height:150px;border-radius:5px;background-position:50%;background-repeat:no-repeat;background-size:cover}.mainContent[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--border-radius:5px;font-weight:600;margin-top:20px}"]}),x)}],T=((N=function t(){e(this,t)}).\u0275fac=function(e){return new(e||N)},N.\u0275mod=g.Jb({type:N}),N.\u0275inj=g.Ib({imports:[[c.i.forChild(S)],c.i]}),N),P=o("PCNd"),I=((A=function t(){e(this,t)}).\u0275fac=function(e){return new(e||A)},A.\u0275mod=g.Jb({type:A}),A.\u0275inj=g.Ib({imports:[[r.b,a.e,s.X,P.a,T]]}),A)}}])}();