(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{Db1F:function(t,e,i){"use strict";i.r(e),i.d(e,"AddNewFoodsPageModule",function(){return A});var o=i("ofXK"),n=i("3Pt+"),s=i("TEn/"),r=i("tyNb"),a=i("mrSG"),l=i("a/9d"),c=i("8RPc"),d=i("2Rin"),h=i("24Ct"),u=i("fXoL");function b(t,e){if(1&t&&(u.Ob(0,"ion-title"),u.rc(1),u.Nb()),2&t){const t=u.Yb();u.Ab(1),u.sc(t.util.translate("Editar producto"))}}function g(t,e){if(1&t&&(u.Ob(0,"ion-title"),u.rc(1),u.Nb()),2&t){const t=u.Yb();u.Ab(1),u.sc(t.util.translate("A\xf1adir producto"))}}function p(t,e){if(1&t&&(u.Ob(0,"ion-select-option",20),u.rc(1),u.Nb()),2&t){const t=e.$implicit;u.ec("value",t.id),u.Ab(1),u.sc(t.name)}}function m(t,e){if(1&t){const t=u.Pb();u.Ob(0,"div",21),u.Wb("click",function(){return u.mc(t),u.Yb().cover()}),u.Mb(1,"ion-icon",22),u.Ob(2,"p"),u.rc(3),u.Nb(),u.Nb()}if(2&t){const t=u.Yb();u.Ab(3),u.sc(t.util.translate("Portada"))}}const v=function(t){return{"background-image":t}};function f(t,e){if(1&t){const t=u.Pb();u.Ob(0,"div",23),u.Wb("click",function(){return u.mc(t),u.Yb().cover()}),u.Nb()}if(2&t){const t=u.Yb();u.ec("ngStyle",u.jc(1,v,"url("+t.api.mediaURL+t.coverImage+"),url(assets/placeholder.jpg)"))}}function O(t,e){if(1&t){const t=u.Pb();u.Ob(0,"ion-icon",28),u.Wb("click",function(){u.mc(t);const e=u.Yb().index;return u.Yb().editTitle(e)}),u.Nb()}}function C(t,e){if(1&t){const t=u.Pb();u.Ob(0,"ion-item",29),u.Ob(1,"ion-label"),u.rc(2),u.Ob(3,"ion-label"),u.rc(4),u.Nb(),u.Nb(),u.Ob(5,"ion-icon",28),u.Wb("click",function(){u.mc(t);const i=e.$implicit,o=e.index,n=u.Yb().index;return u.Yb().editSub(n,i,o)}),u.Nb(),u.Ob(6,"ion-icon",30),u.Wb("click",function(){u.mc(t);const i=e.$implicit,o=u.Yb().index;return u.Yb().deleteSub(o,i)}),u.Nb(),u.Nb()}if(2&t){const t=e.$implicit;u.Ab(2),u.tc("",t.title," "),u.Ab(2),u.sc(t.price)}}function y(t,e){if(1&t){const t=u.Pb();u.Ob(0,"ion-item-sliding"),u.Ob(1,"ion-item",15),u.Ob(2,"ion-label"),u.rc(3),u.Nb(),u.qc(4,O,1,0,"ion-icon",24),u.Ob(5,"ion-icon",25),u.Wb("click",function(){u.mc(t);const i=e.index;return u.Yb().addItem(i)}),u.Nb(),u.Ob(6,"ion-icon",26),u.Wb("click",function(){u.mc(t);const i=e.$implicit;return u.Yb().delete(i)}),u.Nb(),u.Nb(),u.qc(7,C,7,2,"ion-item",27),u.Nb()}if(2&t){const t=e.$implicit;u.Ab(3),u.sc(t.title),u.Ab(1),u.ec("ngIf","size"!==t.title),u.Ab(3),u.ec("ngForOf",t.items)}}const N=[{path:"",component:(()=>{class t{constructor(t,e,i,o,n,s,r,a,l){this.actionSheetController=t,this.camera=e,this.util=i,this.api=o,this.router=n,this.navCtrl=s,this.route=r,this.alertController=a,this.modalCtrl=l,this.categories=[],this.image="",this.isEdit=!1,this.veg="1",this.status="1",this.variations=[],this.size="0",this.category(),this.route.queryParams.subscribe(t=>{console.log("data=>",t),t.hasOwnProperty("id")?(this.id=t.id,this.isEdit=!0,this.getProduct()):this.isEdit=!1})}getProduct(){const t={id:this.id};this.util.show(),this.api.post("products/getById",t).then(t=>{if(console.log(t),this.util.hide(),t&&200===t.status&&t.data.length>0){const e=t.data[0];console.log("info->",e),this.name=e.name,this.descriptions=e.details,this.coverImage=e.cover,this.cid=e.cid,this.price=e.price,this.size=e.size,this.status=e.status,this.veg=e.veg,(t=>{try{return JSON.parse(t),!0}catch(e){return!1}})(e.variations)&&(this.variations=JSON.parse(e.variations))}else this.util.errorToast(this.util.translate("Product not found"))},t=>{console.log(t),this.util.hide(),this.util.errorToast(this.util.translate("Something went wrong"))}).catch(t=>{console.log(t),this.util.hide(),this.util.errorToast(this.util.translate("Something went wrong"))})}ngOnInit(){}category(){const t={id:localStorage.getItem("uid")};this.api.post("categories/getByRestId",t).then(t=>{t&&200===t.status&&t.data.length&&(this.categories=t.data)},t=>{console.log(t),console.log(t),this.util.errorToast(this.util.translate("Something went wrong"))}).catch(t=>{console.log(t),console.log(t),this.util.errorToast(this.util.translate("Something went wrong"))})}changeSize(t){if(console.log(t,this.size),"1"===t){const t=this.variations.filter(t=>"size"===t.title);console.log("length",t),t.length||(this.variations.push({title:"size",type:"radio",items:[]}),console.log(this.variations))}else this.variations=this.variations.filter(t=>"size"!==t.title)}cover(){return Object(a.a)(this,void 0,void 0,function*(){const t=yield this.actionSheetController.create({header:this.util.translate("Choose from"),mode:"ios",buttons:[{text:this.util.translate("Camera"),icon:"camera",handler:()=>{console.log("Delete clicked"),this.opemCamera("camera")}},{text:this.util.translate("Gallery"),icon:"image",handler:()=>{console.log("Share clicked"),this.opemCamera("gallery")}},{text:this.util.translate("Cancel"),icon:"close",role:"cancel",handler:()=>{console.log("Cancel clicked")}}]});yield t.present()})}addNew(){return Object(a.a)(this,void 0,void 0,function*(){const t=yield this.alertController.create({header:"Add Add-ons!",inputs:[{name:"name",type:"text",placeholder:"Title"}],buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:()=>{console.log("Confirm Cancel")}},{text:"Ok",handler:t=>{if(console.log("Confirm Ok"),t&&t.name){const e=this.variations.filter(e=>e.title===t.name);console.log('=>"',e),e&&e.length>0?this.util.errorToast("Duplicate"):this.presentAlertRadio(t.name)}}}]});yield t.present()})}editTitle(t){return Object(a.a)(this,void 0,void 0,function*(){const e=yield this.alertController.create({header:"Edit title!",inputs:[{name:"name",type:"text",placeholder:"Title",value:this.variations[t].title}],buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:()=>{console.log("Confirm Cancel")}},{text:"Ok",handler:e=>{console.log("Confirm Ok"),e&&e.name&&(this.variations[t].title=e.name)}}]});yield e.present()})}presentAlertRadio(t){return Object(a.a)(this,void 0,void 0,function*(){const e=yield this.alertController.create({header:"Select Type",inputs:[{name:"radio1",type:"radio",label:"Only One",value:"radio",checked:!0},{name:"radio2",type:"radio",label:"Multiple",value:"check"}],buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:()=>{console.log("Confirm Cancel")}},{text:"Ok",handler:e=>{console.log("Confirm Ok"),this.variations.push({title:t,type:e,items:[]}),console.log(this.variations)}}]});yield e.present()})}opemCamera(t){try{this.camera.getPicture({quality:100,targetHeight:800,targetWidth:800,destinationType:this.camera.DestinationType.DATA_URL,encodingType:this.camera.EncodingType.JPEG,mediaType:this.camera.MediaType.PICTURE,correctOrientation:!0,sourceType:"camera"===t?this.camera.PictureSourceType.CAMERA:this.camera.PictureSourceType.PHOTOLIBRARY}).then(t=>{console.log("url->",t),this.util.show();const e={img:t,type:"jpg"};console.log("parma==>",e),this.api.nativePost("users/upload_file",e).then(t=>{this.util.hide(),console.log("data",JSON.parse(t.data));const e=JSON.parse(t.data);this.coverImage=e.data,console.log("cover image",this.coverImage)},t=>{console.log(t),this.util.hide(),this.util.errorToast(this.util.translate("Something went wrong"))}).catch(t=>{console.log(t),this.util.hide(),this.util.errorToast(this.util.translate("Something went wrong"))})})}catch(e){console.log("error",e)}}submit(){if(!(""!==this.name&&this.name&&""!==this.cid&&this.cid&&""!==this.price&&this.price&&""!==this.descriptions&&this.descriptions))return this.util.errorToast(this.util.translate("All Fields are required")),!1;if(!this.coverImage||""===this.coverImage)return this.util.errorToast(this.util.translate("Please add your cover image")),!1;if(this.isEdit&&this.id){const t={restId:localStorage.getItem("uid"),cid:this.cid,name:this.name,price:this.price,details:this.descriptions,cover:this.coverImage,veg:this.veg,status:this.status,variations:JSON.stringify(this.variations),size:this.size,id:this.id};this.util.show(),this.api.post("products/editList",t).then(t=>{this.util.hide(),t&&200===t.status?(this.util.showToast(this.util.translate("Food updated Successfully"),"success","bottom"),this.navCtrl.back()):this.util.errorToast(this.util.translate("Something went wrong"))},t=>{console.log(t),this.util.hide(),this.util.errorToast(this.util.translate("Something went wrong"))}).catch(t=>{console.log(t),this.util.hide(),this.util.errorToast(this.util.translate("Something went wrong"))})}else{const t={restId:localStorage.getItem("uid"),cid:this.cid,name:this.name,price:this.price,details:this.descriptions,cover:this.coverImage,rating:0,veg:this.veg,status:1,variations:JSON.stringify(this.variations),size:this.size};this.util.show(),this.api.post("products/save",t).then(t=>{this.util.hide(),t&&200===t.status?(this.util.showToast(this.util.translate("Food Added Successfully"),"success","bottom"),this.navCtrl.back()):this.util.errorToast(this.util.translate("Something went wrong"))},t=>{console.log(t),this.util.hide(),this.util.errorToast(this.util.translate("Something went wrong"))}).catch(t=>{console.log(t),this.util.hide(),this.util.errorToast(this.util.translate("Something went wrong"))})}}delete(t){console.log(t),"size"===t.title&&(this.size=!1),this.variations=this.variations.filter(e=>e.title!==t.title)}addItem(t){return Object(a.a)(this,void 0,void 0,function*(){console.log(this.variations[t]);const e=yield this.alertController.create({header:"Add item to "+this.variations[t].title,inputs:[{name:"title",type:"text",placeholder:"Add-ons name"},{name:"price",type:"number",placeholder:"Add-ons price"}],buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:()=>{console.log("Confirm Cancel")}},{text:"Ok",handler:e=>{console.log("Confirm Ok"),e&&e.title&&e.price&&(this.variations[t].items.push({title:e.title,price:e.price}),console.log(this.variations))}}]});yield e.present()})}deleteSub(t,e){console.log(t),console.log(e);const i=this.variations[t].items;console.log("selected",i);const o=i.filter(t=>t.title!==e.title);console.log(o),this.variations[t].items=o,console.log("done",this.variations)}editSub(t,e,i){return Object(a.a)(this,void 0,void 0,function*(){console.log(t,e,i),console.log(this.variations);const o=yield this.alertController.create({header:"Edit item "+this.variations[t].title,inputs:[{name:"title",type:"text",placeholder:"Variation name",value:this.variations[t].items[i].title},{name:"price",type:"number",placeholder:"Variation price",value:this.variations[t].items[i].price}],buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:()=>{console.log("Confirm Cancel")}},{text:"Ok",handler:e=>{console.log("Confirm Ok"),this.variations[t].items[i].title=e.title,this.variations[t].items[i].price=e.price,console.log(this.variations)}}]});yield o.present()})}preview(){return Object(a.a)(this,void 0,void 0,function*(){const t=yield this.modalCtrl.create({component:h.a,cssClass:"custom_modal2",componentProps:{name:this.name,variations:this.variations,desc:this.descriptions}});return yield t.present()})}}return t.\u0275fac=function(e){return new(e||t)(u.Lb(s.a),u.Lb(l.a),u.Lb(d.a),u.Lb(c.a),u.Lb(r.g),u.Lb(s.cb),u.Lb(r.a),u.Lb(s.b),u.Lb(s.bb))},t.\u0275cmp=u.Fb({type:t,selectors:[["app-add-new-foods"]],decls:36,vars:17,consts:[["color","primary"],["slot","start"],[3,"click"],["slot","icon-only","name","arrow-back"],[4,"ngIf"],[1,"ion-padding"],[1,"mainContent"],["lines","none"],["interface","popover","mode","ios",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","text",3,"ngModel","placeholder","ngModelChange"],["type","number",3,"ngModel","placeholder","ngModelChange"],["rows","5",3,"ngModel","placeholder","ngModelChange"],["class","coverPlaceholder",3,"click",4,"ngIf"],["class","coverReal",3,"ngStyle","click",4,"ngIf"],[1,"noLines"],["name","add","slot","end",3,"click"],[4,"ngFor","ngForOf"],["size","6"],["expand","block",3,"click"],[3,"value"],[1,"coverPlaceholder",3,"click"],["name","cloud-upload-outline","color","primary"],[1,"coverReal",3,"ngStyle","click"],["name","create-outline","slot","end",3,"click",4,"ngIf"],["name","add-circle","slot","end",3,"click"],["name","trash","slot","end",3,"click"],["class","sub","lines","nones",4,"ngFor","ngForOf"],["name","create-outline","slot","end",3,"click"],["lines","nones",1,"sub"],["name","trash-outline","slot","end",3,"click"]],template:function(t,e){1&t&&(u.Ob(0,"ion-header"),u.Ob(1,"ion-toolbar",0),u.Ob(2,"ion-buttons",1),u.Ob(3,"ion-button",2),u.Wb("click",function(){return e.util.back()}),u.Mb(4,"ion-icon",3),u.Nb(),u.Nb(),u.qc(5,b,2,1,"ion-title",4),u.qc(6,g,2,1,"ion-title",4),u.Nb(),u.Nb(),u.Ob(7,"ion-content",5),u.Ob(8,"div",6),u.Ob(9,"ion-list",7),u.Ob(10,"ion-item"),u.Ob(11,"ion-label"),u.rc(12),u.Nb(),u.Ob(13,"ion-select",8),u.Wb("ngModelChange",function(t){return e.cid=t}),u.qc(14,p,2,2,"ion-select-option",9),u.Nb(),u.Nb(),u.Ob(15,"ion-item"),u.Ob(16,"ion-input",10),u.Wb("ngModelChange",function(t){return e.name=t}),u.Nb(),u.Nb(),u.Ob(17,"ion-item"),u.Ob(18,"ion-input",11),u.Wb("ngModelChange",function(t){return e.price=t}),u.Nb(),u.Nb(),u.Ob(19,"ion-item"),u.Ob(20,"ion-textarea",12),u.Wb("ngModelChange",function(t){return e.descriptions=t}),u.Nb(),u.Nb(),u.qc(21,m,4,1,"div",13),u.qc(22,f,1,3,"div",14),u.Ob(23,"ion-item",15),u.Ob(24,"ion-label"),u.rc(25),u.Nb(),u.Ob(26,"ion-icon",16),u.Wb("click",function(){return e.addNew()}),u.Nb(),u.Nb(),u.Ob(27,"ion-list"),u.qc(28,y,8,3,"ion-item-sliding",17),u.Nb(),u.Ob(29,"ion-row"),u.Ob(30,"ion-col",18),u.Ob(31,"ion-button",19),u.Wb("click",function(){return e.submit()}),u.rc(32),u.Nb(),u.Nb(),u.Ob(33,"ion-col",18),u.Ob(34,"ion-button",19),u.Wb("click",function(){return e.preview()}),u.rc(35),u.Nb(),u.Nb(),u.Nb(),u.Nb(),u.Nb(),u.Nb()),2&t&&(u.Ab(5),u.ec("ngIf",e.isEdit),u.Ab(1),u.ec("ngIf",!e.isEdit),u.Ab(6),u.sc(e.util.translate("Categoria")),u.Ab(1),u.ec("ngModel",e.cid),u.Ab(1),u.ec("ngForOf",e.categories),u.Ab(2),u.ec("ngModel",e.name)("placeholder",e.util.translate("Nombre del producto")),u.Ab(2),u.ec("ngModel",e.price)("placeholder",e.util.translate("Precio")),u.Ab(2),u.ec("ngModel",e.descriptions)("placeholder",e.util.translate("Descripcion corta")),u.Ab(1),u.ec("ngIf",!e.coverImage||""==e.coverImage),u.Ab(1),u.ec("ngIf",e.coverImage&&""!=e.coverImage),u.Ab(3),u.sc(e.util.translate("Extas")),u.Ab(3),u.ec("ngForOf",e.variations),u.Ab(4),u.tc(" ",e.isEdit?"Actualizar":"Agregar"," "),u.Ab(3),u.sc(e.util.translate("Vista previa de extras")))},directives:[s.o,s.W,s.g,s.f,s.p,o.i,s.j,s.u,s.r,s.t,s.I,s.ib,n.i,n.l,o.h,s.q,s.jb,s.eb,s.T,s.E,s.i,s.V,s.J,o.j,s.s],styles:["ion-item[_ngcontent-%COMP%]{border:1px solid #d3d3d3;border-radius:5px;margin-top:10px}.delete_icn[_ngcontent-%COMP%]{color:#fff;font-weight:600}.mainContent[_ngcontent-%COMP%]   .coverPlaceholder[_ngcontent-%COMP%]{text-align:center;padding:60px;border:1px solid #d3d3d3;border-radius:10px;margin-top:10px}.mainContent[_ngcontent-%COMP%]   .coverReal[_ngcontent-%COMP%]{margin-top:10px;width:100%;height:150px;border-radius:5px;background-position:50%;background-repeat:no-repeat;background-size:cover}.mainContent[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--border-radius:5px;font-weight:600;margin-top:20px}"]}),t})()}];let w=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=u.Jb({type:t}),t.\u0275inj=u.Ib({imports:[[r.i.forChild(N)],r.i]}),t})();var k=i("PCNd");let A=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=u.Jb({type:t}),t.\u0275inj=u.Ib({imports:[[o.b,n.e,s.X,k.a,w]]}),t})()}}]);