!function(){function t(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function n(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{akYc:function(e,o,i){"use strict";i.r(o),i.d(o,"TrackerPageModule",function(){return P});var r=i("ofXK"),a=i("3Pt+"),s=i("TEn/"),l=i("tyNb"),c=i("8RPc"),d=i("2Rin"),g=i("m/P+"),p=i("fXoL"),u=["map"];function b(t,n){if(1&t&&(p.Ob(0,"span",19),p.rc(1),p.Nb()),2&t){var e=p.Yb();p.Ab(1),p.uc("",e.util.currecny," ",e.grandTotal,"")}}function v(t,n){if(1&t&&(p.Ob(0,"span",19),p.rc(1),p.Nb()),2&t){var e=p.Yb();p.Ab(1),p.uc("",e.grandTotal,"",e.util.currecny,"")}}var _,m,h,f=function(t){return{"background-image":t}},O=[{path:"",component:(_=function(){function e(n,o,i,r){t(this,e),this.route=n,this.api=o,this.iab=i,this.util=r,this.dName="",this.restAddress="",this.dCover="",this.phone="",this.status="",this.totalOrders=[]}var o,i,r;return o=e,(i=[{key:"ngOnInit",value:function(){var t=this;this.route.queryParams.subscribe(function(n){console.log("data=>",n),n.hasOwnProperty("id")&&(t.id=n.id,t.getOrder())})}},{key:"callDriver",value:function(){this.iab.create("tel:"+this.phone,"_system")}},{key:"getOrder",value:function(){var t=this;this.api.post("orders/getById",{id:this.id}).then(function(n){if(console.log(n),n&&200===n.status&&n.data.length){var e=n.data[0];if(t.totalOrders=JSON.parse(e.orders),t.grandTotal=e.grand_total,t.status=e.status,t.restAddress=e.str_address,t.payMethod="cod"===e.pay_method?"COD":"PAID",e&&e.did&&"0"!==e.did&&(t.dId=e.did,t.getDriverInfo()),e&&e.address){var o=JSON.parse(e.address);console.log(o),t.myLat=o.lat,t.myLng=o.lng}}else t.util.back()},function(n){console.log("error in orders",n),t.util.errorToast("Something went wrong")}).catch(function(n){console.log("error in order",n),t.util.errorToast("Something went wrong")})}},{key:"getDriverInfo",value:function(){var t=this;this.api.post("drivers/getById",{id:this.dId}).then(function(n){if(console.log("driver info---\x3e>",n),n&&200===n.status&&n.data.length){var e=n.data[0];console.log("----\x3e>>>>",e),t.dName=e.first_name+" "+e.last_name,t.dCover=e.cover,t.phone=e.mobile,t.driverLat=e.lat,t.driverLng=e.lng,t.loadMap(parseFloat(t.myLat),parseFloat(t.myLng),parseFloat(t.driverLat),parseFloat(t.driverLng))}},function(n){console.log(n),t.util.errorToast("Something went wrong")}).catch(function(n){console.log(n),t.util.errorToast("Something went wrong")})}},{key:"changeMarkerPosition",value:function(t,n){var e=this;this.api.post("drivers/getById",{id:this.dId}).then(function(o){if(console.log("driver info---\x3e>",o),o&&200===o.status&&o.data.length){var i=o.data[0];console.log("----\x3e>>>>",i),e.dName=i.first_name+" "+i.last_name,e.dCover=i.cover,e.phone=i.mobile,e.driverLat=i.lat,e.driverLng=i.lng;var r=new google.maps.LatLng(parseFloat(e.driverLat),parseFloat(e.driverLng));n.setCenter(r),t.setPosition(r)}},function(t){console.log(t),e.util.errorToast("Something went wrong")}).catch(function(t){console.log(t),e.util.errorToast("Something went wrong")})}},{key:"loadMap",value:function(t,n,e,o){var i=this,r=new google.maps.DirectionsService,a=new google.maps.DirectionsRenderer;a=new google.maps.DirectionsRenderer;var s=new google.maps.LatLngBounds,l={lat:parseFloat(t),lng:parseFloat(n)},c={lat:e,lng:o},d=new google.maps.Map(this.mapElement.nativeElement,{center:{lat:t,lng:n},disableDefaultUI:!0,zoom:100}),g=new google.maps.LatLng(t,n),p=new google.maps.LatLng(e,o),u={url:"assets/pin.png",scaledSize:new google.maps.Size(50,50),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(0,0)},b=new google.maps.Marker({map:d,position:g,animation:google.maps.Animation.DROP,icon:u}),v=new google.maps.Marker({map:d,position:p,animation:google.maps.Animation.DROP,icon:u});b.setMap(d),v.setMap(d),a.setMap(d),a.setOptions({polylineOptions:{strokeWeight:4,strokeOpacity:1,strokeColor:"#ff384c"},suppressMarkers:!0});var _=new google.maps.Geocoder;(new google.maps.DistanceMatrixService).getDistanceMatrix({origins:[l],destinations:[c],travelMode:"DRIVING",unitSystem:google.maps.UnitSystem.METRIC,avoidHighways:!1,avoidTolls:!1},function(t,n){if("OK"!==n)alert("Error was: "+n);else{var e=t.originAddresses,o=t.destinationAddresses,i=function(t){return function(t,n){"OK"===n?d.fitBounds(s.extend(t[0].geometry.location)):alert("Geocode was not successful due to: "+n)}};r.route({origin:l,destination:c,travelMode:"DRIVING"},function(t,n){"OK"===n?a.setDirections(t):window.alert("Directions request failed due to "+n)});for(var g=0;g<e.length;g++){var p=t.rows[g].elements;_.geocode({address:e[g]},i());for(var u=0;u<p.length;u++)_.geocode({address:o[u]},i())}}}),this.interval=setInterval(function(){i.changeMarkerPosition(b,d)},12e3)}},{key:"ionViewDidLeave",value:function(){clearInterval(this.interval)}}])&&n(o.prototype,i),r&&n(o,r),e}(),_.\u0275fac=function(t){return new(t||_)(p.Lb(l.a),p.Lb(c.a),p.Lb(g.a),p.Lb(d.a))},_.\u0275cmp=p.Fb({type:_,selectors:[["app-tracker"]],viewQuery:function(t,n){var e;1&t&&p.wc(u,3),2&t&&p.kc(e=p.Xb())&&(n.mapElement=e.first)},decls:36,vars:16,consts:[["color","primary"],["slot","start"],[3,"click"],["slot","icon-only","name","arrow-back"],[1,"main_content_div"],[1,"upper_div"],["id","map",1,"map"],["map",""],[1,"lower_div"],[1,"head_lbl"],[1,"driver_detail_div"],[1,"back_image",3,"ngStyle"],[2,"padding-left","20px"],[1,"boy_name"],[1,"address"],["size","small","fill","outline",3,"click"],[1,"order_detail"],["style","color: var(--ion-color-primary);position: absolute;right: 20px;",4,"ngIf"],[1,"order_status"],[2,"color","var(--ion-color-primary)","position","absolute","right","20px"]],template:function(t,n){1&t&&(p.Ob(0,"ion-header"),p.Ob(1,"ion-toolbar",0),p.Ob(2,"ion-buttons",1),p.Ob(3,"ion-button",2),p.Wb("click",function(){return n.util.back()}),p.Mb(4,"ion-icon",3),p.Nb(),p.Nb(),p.Ob(5,"ion-title"),p.rc(6),p.Nb(),p.Nb(),p.Nb(),p.Ob(7,"ion-content"),p.Ob(8,"div",4),p.Ob(9,"div",5),p.Mb(10,"div",6,7),p.Nb(),p.Ob(12,"div",8),p.Ob(13,"ion-label",9),p.rc(14),p.Nb(),p.Ob(15,"div",10),p.Mb(16,"div",11),p.Ob(17,"div",12),p.Ob(18,"ion-label",13),p.rc(19),p.Nb(),p.Ob(20,"ion-label",14),p.rc(21),p.Nb(),p.Ob(22,"ion-button",15),p.Wb("click",function(){return n.callDriver()}),p.rc(23),p.Nb(),p.Nb(),p.Nb(),p.Ob(24,"ion-label",16),p.rc(25),p.qc(26,b,2,2,"span",17),p.qc(27,v,2,2,"span",17),p.Nb(),p.Ob(28,"ion-label",16),p.rc(29),p.Ob(30,"span",18),p.rc(31),p.Nb(),p.Nb(),p.Ob(32,"ion-label",16),p.rc(33),p.Ob(34,"span",18),p.rc(35),p.Nb(),p.Nb(),p.Nb(),p.Nb(),p.Nb()),2&t&&(p.Ab(6),p.sc(n.util.translate("Tracking")),p.Ab(8),p.sc(n.util.translate("Order on the Way")),p.Ab(2),p.ec("ngStyle",p.jc(14,f,"url("+n.api.mediaURL+n.dCover+"),url(assets/placeholder.jpg)")),p.Ab(3),p.sc(n.dName),p.Ab(2),p.sc(n.restAddress),p.Ab(2),p.tc(" ",n.util.translate("Call")," "),p.Ab(2),p.uc("",n.totalOrders.length," ",n.util.translate("Items to deliver")," "),p.Ab(1),p.ec("ngIf","left"===n.util.cside),p.Ab(1),p.ec("ngIf","right"===n.util.cside),p.Ab(2),p.sc(n.util.translate("Order Status")),p.Ab(2),p.sc(n.status),p.Ab(2),p.sc(n.util.translate("Payment")),p.Ab(2),p.sc(n.payMethod))},directives:[s.o,s.W,s.g,s.f,s.p,s.V,s.j,s.t,r.j,r.i],styles:[".main_content_div[_ngcontent-%COMP%]{width:100%;height:100vh;display:flex;flex-direction:column;justify-content:space-between}.main_content_div[_ngcontent-%COMP%]   .upper_div[_ngcontent-%COMP%]{height:60vh}.main_content_div[_ngcontent-%COMP%]   .upper_div[_ngcontent-%COMP%]   #map[_ngcontent-%COMP%]{width:100%;height:100%}.main_content_div[_ngcontent-%COMP%]   .lower_div[_ngcontent-%COMP%]{height:40vh;padding:20px}.main_content_div[_ngcontent-%COMP%]   .lower_div[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{display:block}.main_content_div[_ngcontent-%COMP%]   .lower_div[_ngcontent-%COMP%]   .head_lbl[_ngcontent-%COMP%]{font-weight:600;font-size:20px;margin-top:10px}.main_content_div[_ngcontent-%COMP%]   .lower_div[_ngcontent-%COMP%]   .driver_detail_div[_ngcontent-%COMP%]{margin-top:20px;display:flex;flex-direction:row;align-items:center;position:relative}.main_content_div[_ngcontent-%COMP%]   .lower_div[_ngcontent-%COMP%]   .driver_detail_div[_ngcontent-%COMP%]   .back_image[_ngcontent-%COMP%]{height:50px;width:50px;border-radius:100%;background-position:50%;background-size:cover;background-repeat:no-repeat;min-width:50px}.main_content_div[_ngcontent-%COMP%]   .lower_div[_ngcontent-%COMP%]   .driver_detail_div[_ngcontent-%COMP%]   .boy_name[_ngcontent-%COMP%]{font-weight:600}.main_content_div[_ngcontent-%COMP%]   .lower_div[_ngcontent-%COMP%]   .driver_detail_div[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]{color:gray;width:80%}.main_content_div[_ngcontent-%COMP%]   .lower_div[_ngcontent-%COMP%]   .driver_detail_div[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{position:absolute;right:-3px;top:-5px;--border-radius:3px;font-weight:600}.main_content_div[_ngcontent-%COMP%]   .lower_div[_ngcontent-%COMP%]   .order_detail[_ngcontent-%COMP%]{font-weight:700;margin-top:20px}.main_content_div[_ngcontent-%COMP%]   .lower_div[_ngcontent-%COMP%]   .order_status[_ngcontent-%COMP%]{background:var(--ion-color-primary);position:absolute;right:20px;text-transform:uppercase;color:#fff;padding:3px 8px;border-radius:3px}"]}),_)}],w=((m=function n(){t(this,n)}).\u0275fac=function(t){return new(t||m)},m.\u0275mod=p.Jb({type:m}),m.\u0275inj=p.Ib({imports:[[l.i.forChild(O)],l.i]}),m),M=i("PCNd"),P=((h=function n(){t(this,n)}).\u0275fac=function(t){return new(t||h)},h.\u0275mod=p.Jb({type:h}),h.\u0275inj=p.Ib({imports:[[r.b,a.e,s.X,M.a,w]]}),h)}}])}();